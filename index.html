<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description"
        content="Le guide ultime pour voyager √† Madagascar - Spots locaux authentiques, carte interactive offline, expressions malgaches">
    <meta name="theme-color" content="#C13535">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <title>MG Guide Voyage Madagascar - Le guide que seuls les Malgaches connaissent</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="shortcut icon" href="icons/favicon.ico">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Inter:wght@300;400;500;600&family=Roboto+Mono:wght@400;500&display=swap"
        rel="stylesheet">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="styles-map.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

    <style>
        /* ============================================
           VARIABLES CSS & RESET
           ============================================ */
        :root {
            /* Couleurs principales (identit√© malgache) */
            --laterite: #C13535;
            --foret: #3A5F3A;
            --sable: #D8B48F;
            --creme: #F9F5F0;
            --noir: #12100E;

            /* Statuts */
            --gratuit: #16A34A;
            --abordable: #F59E0B;
            --premium: #DC2626;

            /* UI */
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.15);
            --radius: 12px;
            --radius-sm: 8px;

            /* Typographie */
            --font-display: 'Quicksand', sans-serif;
            --font-body: 'Inter', sans-serif;
            --font-mono: 'Roboto Mono', monospace;

            /* Mode clair (d√©faut) */
            --bg-primary: var(--creme);
            --bg-secondary: #FFFFFF;
            --text-primary: var(--noir);
            --text-secondary: #6B7280;
            --border-color: #E5E7EB;
        }

        [data-theme="dark"] {
            --bg-primary: #1A1A1A;
            --bg-secondary: #2D2D2D;
            --text-primary: #F9F5F0;
            --text-secondary: #9CA3AF;
            --border-color: #404040;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* ============================================
           HEADER PREMIUM (NON SCROLLABLE)
           ============================================ */
        .header-premium {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: linear-gradient(135deg, var(--laterite) 0%, var(--foret) 100%);
            color: white;
            padding: 16px 20px;
            box-shadow: var(--shadow-lg);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
        }

        .header-left {
            flex: 1;
        }

        .header-title {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .badge-premium {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: var(--noir);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .header-tagline {
            font-size: 0.875rem;
            opacity: 0.95;
            font-style: italic;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 24px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        /* ============================================
           NAVIGATION SCROLLABLE
           ============================================ */
        .nav-container {
            position: sticky;
            top: 80px;
            z-index: 999;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .nav-container::-webkit-scrollbar {
            display: none;
        }

        .main-nav {
            display: flex;
            gap: 8px;
            padding: 12px 20px;
            min-width: max-content;
        }

        .nav-btn {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 24px;
            padding: 10px 20px;
            font-family: var(--font-body);
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-btn:hover {
            background: var(--laterite);
            border-color: var(--laterite);
            color: white;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: var(--laterite);
            border-color: var(--laterite);
            color: white;
            font-weight: 600;
        }

        /* ============================================
           MAIN CONTENT
           ============================================ */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .page-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============================================
           CARTE INTERACTIVE
           ============================================ */
        #map {
            height: 500px;
            width: 100%;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
        }

        .map-filters {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .filter-group {
            margin-bottom: 16px;
        }

        .filter-group:last-child {
            margin-bottom: 0;
        }

        .filter-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .filter-checkbox {
            display: none;
        }

        .filter-label {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            padding: 6px 14px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .filter-checkbox:checked+.filter-label {
            background: var(--laterite);
            border-color: var(--laterite);
            color: white;
            font-weight: 500;
        }

        .filter-label:hover {
            border-color: var(--laterite);
        }

        /* ============================================
           SHORTCUTS RAPIDES
           ============================================ */
        .shortcuts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }

        .shortcut-card {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .shortcut-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--laterite);
        }

        .shortcut-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .shortcut-title {
            font-family: var(--font-display);
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .shortcut-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* ============================================
           CARDS LIEUX
           ============================================ */
        .lieux-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .lieu-card {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .lieu-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--laterite);
        }

        .lieu-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: var(--sable);
        }

        .lieu-content {
            padding: 16px;
        }

        .lieu-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }

        .lieu-title {
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
        }

        .badge-spot {
            background: var(--laterite);
            color: white;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .badge-type {
            background: var(--foret);
            color: white;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .lieu-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .lieu-prix {
            font-family: var(--font-mono);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .lieu-prix.gratuit {
            color: var(--gratuit);
        }

        .lieu-prix.abordable {
            color: var(--abordable);
        }

        .lieu-prix.premium {
            color: var(--premium);
        }

        .lieu-note {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .lieu-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .btn-details {
            width: 100%;
            background: var(--laterite);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            padding: 12px;
            font-family: var(--font-body);
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-details:hover {
            background: #A12929;
            transform: scale(1.02);
        }

        .btn-details:active {
            transform: scale(0.98);
        }

        /* ============================================
           MODAL D√âTAILS
           ============================================ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            overflow-y: auto;
            animation: fadeIn 0.2s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: rgba(0, 0, 0, 0.7);
            transform: scale(1.1);
        }

        .modal-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }

        .modal-body {
            padding: 24px;
        }

        .modal-title {
            font-family: var(--font-display);
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .modal-section {
            margin-bottom: 20px;
        }

        .modal-section-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: var(--laterite);
        }

        .modal-section-content {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .modal-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .modal-info-item {
            background: var(--bg-primary);
            padding: 12px;
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--laterite);
        }

        .modal-info-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .modal-info-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* ============================================
           LANGUE - ACCORD√âONS
           ============================================ */
        .langue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            border: 2px solid var(--border-color);
            border-radius: 24px;
            font-family: var(--font-body);
            font-size: 0.95rem;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--laterite);
            box-shadow: 0 0 0 3px rgba(193, 53, 53, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        .accordion-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .accordion-item {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 2px solid transparent;
            transition: border-color 0.2s ease;
        }

        .accordion-item.open {
            border-color: var(--laterite);
        }

        .accordion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            cursor: pointer;
            user-select: none;
            background: var(--bg-secondary);
            transition: background 0.2s ease;
        }

        .accordion-header:hover {
            background: var(--bg-primary);
        }

        .accordion-title {
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .accordion-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .accordion-item.open .accordion-icon {
            transform: rotate(180deg);
        }

        .accordion-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .accordion-item.open .accordion-body {
            max-height: 2000px;
        }

        .accordion-content {
            padding: 0 20px 20px 20px;
        }

        .phrase-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
            margin-bottom: 8px;
            transition: all 0.2s ease;
        }

        .phrase-item:hover {
            background: var(--bg-secondary);
            transform: translateX(4px);
        }

        .phrase-content {
            flex: 1;
        }

        .phrase-fr {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .phrase-mg {
            color: var(--laterite);
            font-weight: 600;
            margin-bottom: 2px;
        }

        .phrase-phonetic {
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-style: italic;
        }

        .phrase-actions {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            background: var(--laterite);
            color: white;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .btn-icon:hover {
            background: #A12929;
            transform: scale(1.1);
        }

        .btn-icon:active {
            transform: scale(0.9);
        }

        .btn-icon.favorite.active {
            background: #FFD700;
            color: var(--noir);
        }

        /* ============================================
           OUTILS
           ============================================ */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .tool-card {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 24px;
            box-shadow: var(--shadow);
        }

        .tool-title {
            font-family: var(--font-display);
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .converter-inputs {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .converter-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .converter-input {
            flex: 1;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-family: var(--font-mono);
            font-size: 1.1rem;
            font-weight: 500;
            background: var(--bg-primary);
            color: var(--text-primary);
            text-align: center;
        }

        .converter-input:focus {
            outline: none;
            border-color: var(--laterite);
        }

        .converter-label {
            font-weight: 600;
            color: var(--text-secondary);
            min-width: 50px;
        }

        .rate-info {
            text-align: center;
            padding: 12px;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 8px;
        }

        .btn-modify {
            margin-top: 12px;
            background: var(--foret);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            padding: 10px 16px;
            font-family: var(--font-body);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-modify:hover {
            background: #2D4A2D;
        }

        .checklist-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .checklist-item:hover {
            background: var(--bg-secondary);
            transform: translateX(4px);
        }

        .checklist-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .checklist-item.checked .checklist-checkbox {
            background: var(--gratuit);
            border-color: var(--gratuit);
        }

        .checklist-checkbox::after {
            content: '‚úì';
            color: white;
            font-weight: bold;
            display: none;
        }

        .checklist-item.checked .checklist-checkbox::after {
            display: block;
        }

        .checklist-label {
            flex: 1;
            color: var(--text-primary);
        }

        .checklist-item.checked .checklist-label {
            text-decoration: line-through;
            opacity: 0.6;
        }

        .seasonal-advice {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .advice-item {
            padding: 16px;
            border-radius: var(--radius-sm);
            border-left: 4px solid;
        }

        .advice-item.good {
            background: rgba(22, 163, 74, 0.1);
            border-color: var(--gratuit);
        }

        .advice-item.warning {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--abordable);
        }

        .advice-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .advice-list {
            color: var(--text-secondary);
            font-size: 0.9rem;
            list-style-position: inside;
        }

        .contacts-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .contact-group-title {
            font-weight: 600;
            color: var(--laterite);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .contact-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
        }

        .contact-name {
            color: var(--text-primary);
        }

        .contact-number {
            font-family: var(--font-mono);
            color: var(--laterite);
            font-weight: 500;
        }

        /* ============================================
           RESPONSIVE
           ============================================ */
        @media (max-width: 768px) {
            .header-title {
                font-size: 1.2rem;
            }

            .header-tagline {
                font-size: 0.8rem;
            }

            .theme-toggle {
                width: 44px;
                height: 44px;
            }

            .nav-container {
                top: 72px;
            }

            .main-nav {
                padding: 10px 16px;
                gap: 6px;
            }

            .nav-btn {
                padding: 8px 16px;
                font-size: 0.85rem;
            }

            .main-content {
                padding: 16px;
            }

            #map {
                height: 400px;
            }

            .shortcuts-grid {
                grid-template-columns: 1fr;
            }

            .lieux-grid {
                grid-template-columns: 1fr;
            }

            .tools-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 10px;
            }

            .modal-title {
                font-size: 1.5rem;
            }
        }

        @media (min-width: 1024px) {
            #map {
                height: 600px;
            }
        }

        /* ============================================
           UTILITAIRES
           ============================================ */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        /* Leaflet popup customization */
        .leaflet-popup-content-wrapper {
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-lg);
        }

        .leaflet-popup-content {
            margin: 12px;
            font-family: var(--font-body);
        }

        .popup-content {
            min-width: 200px;
        }

        .popup-title {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 6px;
            color: var(--noir);
        }

        .popup-price {
            font-family: var(--font-mono);
            font-size: 0.9rem;
            margin-bottom: 4px;
        }

        .popup-rating {
            font-size: 0.85rem;
            color: #666;
        }

        /* Installation prompt */
        .install-prompt {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--laterite);
            color: white;
            padding: 16px 24px;
            border-radius: 50px;
            box-shadow: var(--shadow-lg);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 9999;
            animation: slideUp 0.3s ease;
        }

        .install-prompt.active {
            display: flex;
        }

        .install-btn {
            background: white;
            color: var(--laterite);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .install-btn:hover {
            transform: scale(1.05);
        }

        .install-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            margin-left: 8px;
        }
    </style>
</head>

<body>
    <!-- Header Premium -->
    <header class="header-premium">
        <div class="header-content">
            <div class="header-left">
                <h1 class="header-title">
                    üåç MG Guide Voyage Madagascar
                    <span class="badge-premium">PREMIUM</span>
                </h1>
                <p class="header-tagline">Le guide que seuls les Malgaches connaissent</p>
            </div>
            <button class="theme-toggle" id="themeToggle" aria-label="Changer de th√®me">
                ‚òÄÔ∏è
            </button>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-container">
        <div class="main-nav" id="mainNav">
            <button class="nav-btn active" data-page="carte">üó∫Ô∏è Carte</button>
            <button class="nav-btn" data-page="antananarivo">üèõÔ∏è Antananarivo</button>
            <button class="nav-btn" data-page="diego">üèùÔ∏è Diego-Suarez</button>
            <button class="nav-btn" data-page="nosybe">üå¥ Nosy Be</button>
            <button class="nav-btn" data-page="mahajanga">üåä Mahajanga</button>
            <button class="nav-btn" data-page="andasibe">üåø Andasibe</button>
            <button class="nav-btn" data-page="isalo">üèúÔ∏è Isalo</button>
            <button class="nav-btn" data-page="ifaty">üèñÔ∏è Ifaty</button>
            <button class="nav-btn" data-page="ankarana">üï≥Ô∏è Ankarana</button>
            <button class="nav-btn" data-page="mananara">üêä Mananara</button>
            <button class="nav-btn" data-page="spots">üî• Spots Locaux</button>
            <button class="nav-btn" data-page="langue">üó£Ô∏è Langue</button>
            <button class="nav-btn" data-page="outils">üß∞ Outils</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Carte -->
        <section id="page-carte" class="page-section active">
            <!-- Filtres -->
            <div class="map-filters">
                <div class="filter-group">
                    <div class="filter-title">üìç Villes</div>
                    <div class="filter-options">
                        <input type="checkbox" id="filter-antananarivo" class="filter-checkbox" checked>
                        <label for="filter-antananarivo" class="filter-label">Antananarivo</label>

                        <input type="checkbox" id="filter-diego" class="filter-checkbox" checked>
                        <label for="filter-diego" class="filter-label">Diego-Suarez</label>

                        <input type="checkbox" id="filter-nosybe" class="filter-checkbox" checked>
                        <label for="filter-nosybe" class="filter-label">Nosy Be</label>

                        <input type="checkbox" id="filter-mahajanga" class="filter-checkbox" checked>
                        <label for="filter-mahajanga" class="filter-label">Mahajanga</label>

                        <input type="checkbox" id="filter-andasibe" class="filter-checkbox" checked>
                        <label for="filter-andasibe" class="filter-label">Andasibe</label>

                        <input type="checkbox" id="filter-isalo" class="filter-checkbox" checked>
                        <label for="filter-isalo" class="filter-label">Isalo</label>

                        <input type="checkbox" id="filter-ifaty" class="filter-checkbox" checked>
                        <label for="filter-ifaty" class="filter-label">Ifaty</label>

                        <input type="checkbox" id="filter-ankarana" class="filter-checkbox" checked>
                        <label for="filter-ankarana" class="filter-label">Ankarana</label>

                        <input type="checkbox" id="filter-mananara" class="filter-checkbox" checked>
                        <label for="filter-mananara" class="filter-label">Mananara</label>
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-title">üè∑Ô∏è Types</div>
                    <div class="filter-options">
                        <input type="checkbox" id="filter-incontournable" class="filter-checkbox" checked>
                        <label for="filter-incontournable" class="filter-label">Incontournable</label>

                        <input type="checkbox" id="filter-spotlocal" class="filter-checkbox" checked>
                        <label for="filter-spotlocal" class="filter-label">Spot Local</label>

                        <input type="checkbox" id="filter-nature" class="filter-checkbox" checked>
                        <label for="filter-nature" class="filter-label">Nature</label>

                        <input type="checkbox" id="filter-restaurant" class="filter-checkbox" checked>
                        <label for="filter-restaurant" class="filter-label">Restaurant</label>

                        <input type="checkbox" id="filter-culture" class="filter-checkbox" checked>
                        <label for="filter-culture" class="filter-label">Culture</label>
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-title">üí∞ Prix</div>
                    <div class="filter-options">
                        <input type="checkbox" id="filter-gratuit" class="filter-checkbox" checked>
                        <label for="filter-gratuit" class="filter-label">Gratuit</label>

                        <input type="checkbox" id="filter-economique" class="filter-checkbox" checked>
                        <label for="filter-economique" class="filter-label">&lt; 10 000 Ar</label>

                        <input type="checkbox" id="filter-moyen" class="filter-checkbox" checked>
                        <label for="filter-moyen" class="filter-label">‚â• 10 000 Ar</label>
                    </div>
                </div>
            </div>

            <!-- Carte -->
            <div id="map-container">
                <div id="map"></div>
            </div>

            <!-- Shortcuts -->
            <div class="shortcuts-grid">
                <div class="shortcut-card" data-goto="spots">
                    <div class="shortcut-icon">üî•</div>
                    <h3 class="shortcut-title">Spots Locaux</h3>
                    <p class="shortcut-desc">9 lieux secrets accessibles uniquement via contact local</p>
                </div>

                <div class="shortcut-card" data-goto="langue">
                    <div class="shortcut-icon">üó£Ô∏è</div>
                    <h3 class="shortcut-title">50+ Expressions</h3>
                    <p class="shortcut-desc">Phrases essentielles en malgache avec prononciation audio</p>
                </div>

                <div class="shortcut-card" data-goto="outils">
                    <div class="shortcut-icon">üß∞</div>
                    <h3 class="shortcut-title">Outils Terrain</h3>
                    <p class="shortcut-desc">Convertisseur devises, checklist voyage, num√©ros utiles</p>
                </div>
            </div>
        </section>

        <!-- Pages Villes (template dynamique) -->
        <section id="page-antananarivo" class="page-section"></section>
        <section id="page-diego" class="page-section"></section>
        <section id="page-nosybe" class="page-section"></section>
        <section id="page-mahajanga" class="page-section"></section>
        <section id="page-andasibe" class="page-section"></section>
        <section id="page-isalo" class="page-section"></section>
        <section id="page-ifaty" class="page-section"></section>
        <section id="page-ankarana" class="page-section"></section>
        <section id="page-mananara" class="page-section"></section>

        <!-- Page Spots Locaux -->
        <section id="page-spots" class="page-section">
            <h2 class="page-title"
                style="font-family: var(--font-display); font-size: 2rem; margin-bottom: 20px; color: var(--laterite);">
                üî• Spots Locaux Authentiques</h2>
            <p style="color: var(--text-secondary); margin-bottom: 30px; font-size: 1.1rem;">
                Ces lieux sont <strong>inaccessibles sans contact humain local</strong>. Non r√©f√©renc√©s sur Google Maps,
                absents des guides touristiques traditionnels.
            </p>
            <div id="spotsContainer" class="lieux-grid"></div>
        </section>

        <!-- Page Langue -->
        <section id="page-langue" class="page-section">
            <div class="langue-header">
                <h2 style="font-family: var(--font-display); font-size: 2rem; color: var(--text-primary);">üó£Ô∏è
                    Expressions Malgaches</h2>
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="langueSearch" class="search-input"
                        placeholder="Rechercher une expression...">
                </div>
            </div>

            <div id="accordionContainer" class="accordion-container"></div>
        </section>

        <!-- Page Outils -->
        <section id="page-outils" class="page-section">
            <h2
                style="font-family: var(--font-display); font-size: 2rem; margin-bottom: 30px; color: var(--text-primary);">
                üß∞ Outils Terrain</h2>

            <div class="tools-grid">
                <!-- Convertisseur -->
                <div class="tool-card">
                    <h3 class="tool-title">üí± Convertisseur Ar ‚Üî ‚Ç¨</h3>
                    <div class="converter-inputs">
                        <div class="converter-row">
                            <span class="converter-label">Ar</span>
                            <input type="number" id="inputAr" class="converter-input" value="42500" min="0">
                        </div>
                        <div style="text-align: center; color: var(--text-secondary); font-size: 1.5rem;">‚áÖ</div>
                        <div class="converter-row">
                            <span class="converter-label">‚Ç¨</span>
                            <input type="number" id="inputEuro" class="converter-input" value="10" min="0" step="0.01">
                        </div>
                    </div>
                    <div class="rate-info">
                        Taux : 1 ‚Ç¨ = <span id="rateDisplay">4250</span> Ar
                    </div>
                    <button class="btn-modify" id="btnModifyRate">Modifier le taux</button>
                </div>

                <!-- Checklist -->
                <div class="tool-card">
                    <h3 class="tool-title">‚úÖ Checklist Voyage</h3>
                    <div class="checklist-items" id="checklistContainer"></div>
                </div>

                <!-- Conseils Saisonniers -->
                <div class="tool-card">
                    <h3 class="tool-title">üìÖ Conseils Saisonniers</h3>
                    <div class="seasonal-advice">
                        <div class="advice-item good">
                            <div class="advice-title">üåû Meilleure p√©riode : MAI √† OCTOBRE</div>
                            <ul class="advice-list">
                                <li>M√©t√©o stable, routes praticables</li>
                                <li>Observation l√©muriens optimale</li>
                                <li>Temp√©ratures agr√©ables (20-25¬∞C)</li>
                            </ul>
                        </div>
                        <div class="advice-item warning">
                            <div class="advice-title">‚ö†Ô∏è √Ä √©viter : JANVIER √† MARS</div>
                            <ul class="advice-list">
                                <li>Saison des pluies (cyclones possibles)</li>
                                <li>Routes coup√©es, parcs ferm√©s</li>
                                <li>Forte humidit√©</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Num√©ros Utiles -->
                <div class="tool-card">
                    <h3 class="tool-title">üìû Num√©ros Utiles</h3>
                    <div class="contacts-list">
                        <div>
                            <div class="contact-group-title">üö® Urgences</div>
                            <div class="contact-item">
                                <span class="contact-name">Police</span>
                                <span class="contact-number">117</span>
                            </div>
                            <div class="contact-item">
                                <span class="contact-name">Pompiers</span>
                                <span class="contact-number">118</span>
                            </div>
                            <div class="contact-item">
                                <span class="contact-name">Ambulance</span>
                                <span class="contact-number">119</span>
                            </div>
                        </div>

                        <div>
                            <div class="contact-group-title">üèõÔ∏è Ambassades</div>
                            <div class="contact-item">
                                <span class="contact-name">France</span>
                                <span class="contact-number">+261 20 22 399 98</span>
                            </div>
                            <div class="contact-item">
                                <span class="contact-name">Belgique</span>
                                <span class="contact-number">+261 20 22 241 69</span>
                            </div>
                        </div>

                        <div>
                            <div class="contact-group-title">üì∂ Op√©rateurs</div>
                            <div class="contact-item">
                                <span class="contact-name">Telma</span>
                                <span class="contact-number">*111#</span>
                            </div>
                            <div class="contact-item">
                                <span class="contact-name">Airtel</span>
                                <span class="contact-number">*121#</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal D√©tails -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">√ó</button>
            <img id="modalImage" class="modal-image" src="" alt="" loading="lazy">
            <div class="modal-body">
                <h2 id="modalTitle" class="modal-title"></h2>
                <div id="modalBadges" style="margin-bottom: 16px;"></div>
                <div id="modalInfoGrid" class="modal-info-grid"></div>
                <div id="modalSections"></div>
            </div>
        </div>
    </div>

    <!-- Install Prompt -->
    <div id="installPrompt" class="install-prompt">
        <span>üì± Installer l'app pour un acc√®s offline</span>
        <button class="install-btn" id="installBtn">Installer</button>
        <button class="install-close" id="installClose">√ó</button>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>


    <script>
        // ============================================
        // DONN√âES
        // ============================================

        const LIEUX_DATA = [
            {
                id: 1,
                ville: "Antananarivo",
                nom: "Palais de la Reine (Rova)",
                type: "Incontournable",
                lat: -18.9151,
                lng: 47.5283,
                prix: "10 000 Ar",
                prixEur: "2 ‚Ç¨",
                prixNum: 10000,
                note: 4.5,
                description: "Le Rova de Manjakamiadana est le c≈ìur historique et spirituel de l'Imerina. Perch√© sur la plus haute colline, ce complexe royal offre une plong√©e fascinante dans l'histoire des monarques malgaches et une vue imprenable √† 360¬∞ sur toute la ville.",
                image: "images/villes/palais-reine.jpg",
                acces: "Centre-ville d'Antananarivo, colline d'Ambohimanga",
                horaires: "9h-17h tous les jours",
                respect: "Tenue correcte exig√©e, pas de short",
                conseil: "Prenez un guide officiel √† l'entr√©e pour comprendre l'histoire complexe des incendies et de la reconstruction.",
                duree: "1h30"
            },
            {
                id: 2,
                ville: "Antananarivo",
                nom: "March√© Artisanal de La Digue",
                type: "Culture",
                lat: -18.9087,
                lng: 47.5236,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.3,
                description: "Le plus grand march√© artisanal de la capitale. Un labyrinthe de couleurs et de senteurs o√π vous trouverez tout l'artisanat malgache : vannerie, marqueterie, pierres semi-pr√©cieuses, broderies et sculptures en bois. L'endroit id√©al pour vos souvenirs.",
                image: "images/villes/marche-la-digue.jpg",
                acces: "Avenue de l'Ind√©pendance",
                horaires: "8h-18h du lundi au samedi",
                conseil: "Le marchandage est de rigueur ici ! Divisez le premier prix annonc√© par deux ou trois, toujours avec le sourire.",
                duree: "2h"
            },
            {
                id: 3,
                ville: "Antananarivo",
                nom: "Parc de Tsarasaotra",
                type: "Nature",
                lat: -18.9352,
                lng: 47.5467,
                prix: "5 000 Ar",
                prixEur: "1 ‚Ç¨",
                prixNum: 5000,
                note: 4.6,
                description: "Un havre de paix inattendu en plein c≈ìur de la ville. Ce parc priv√© class√© RAMSAR est un refuge vital pour de nombreuses esp√®ces d'oiseaux end√©miques, dont le h√©ron de Humblot. Parfait pour une pause nature loin du tumulte urbain.",
                image: "images/spots/parc-tsarasaotra.jpg",
                acces: "Quartier Tsarasaotra",
                horaires: "7h-17h tous les jours",
                conseil: "Apportez des jumelles si vous en avez, c'est un paradis pour l'ornithologie, surtout t√¥t le matin.",
                duree: "1h"
            },
            {
                id: 4,
                ville: "Antananarivo",
                nom: "Source Sacr√©e d'Ambohijatovo",
                type: "Spot Local",
                lat: -18.9151,
                lng: 47.5283,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.0,
                description: "Une source mystique charg√©e de l√©gendes, v√©n√©r√©e par les habitants du quartier. On dit que son eau poss√®de des vertus purificatrices. C'est un lieu secret, hors des guides touristiques classiques, o√π l'on ressent la spiritualit√© quotidienne malgache.",
                image: "images/spots/source-ambohijatovo.jpg",
                acces: "Pas de GPS - Derri√®re l'√©glise Andohalo, demander au gardien qui montre le chemin",
                contactLocal: "Le gardien de l'√©glise (pr√©sent le matin)",
                respect: "Offrande traditionnelle recommand√©e, silence requis, ne pas toucher l'eau sans permission",
                conseil: "Montrez du respect et demandez toujours la permission avant de prendre une photo. Une petite pi√®ce au gardien est appr√©ci√©e.",
                duree: "30 min"
            },
            {
                id: 5,
                ville: "Antananarivo",
                nom: "Restaurant La Varangue",
                type: "Restaurant",
                lat: -18.9122,
                lng: 47.5341,
                prix: "40 000 Ar",
                prixEur: "9 ‚Ç¨",
                prixNum: 40000,
                note: 4.7,
                description: "Une institution gastronomique √† Tana. Install√© dans une magnifique villa coloniale remplie d'antiquit√©s, ce restaurant propose une cuisine fusion raffin√©e. Le cadre est aussi exquis que les plats, avec une collection d'objets d'art h√©t√©roclite fascinante.",
                image: "images/restaurants/la-varangue.jpg",
                acces: "Rue Printsy Ratsimamanga, Isoraka",
                horaires: "12h-14h30 et 19h-22h",
                conseil: "R√©servez une table en terrasse ou pr√®s de la chemin√©e en hiver. Essayez leur foie gras maison.",
                duree: "2h"
            },
            {
                id: 6,
                ville: "Diego-Suarez",
                nom: "Plage de Ramena",
                type: "Plage",
                lat: -12.2167,
                lng: 49.3833,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.5,
                description: "Bien plus qu'une simple plage, Ramena est un village de p√™cheurs vibrant. La plage de sable blanc s'√©tire sur des kilom√®tres, bord√©e de gargotes servant du poisson grill√© fra√Æchement p√™ch√©. L'ambiance y est d√©tendue et festive le dimanche.",
                image: "images/iles/plage-ramena.jpg",
                acces: "18 km de Diego, taxi-brousse ou taxi",
                horaires: "Accessible 24h/24",
                conseil: "Commandez des brochettes de poisson dans une gargote le midi. Le soir, attention aux moustiques !",
                duree: "Demi-journ√©e"
            },
            {
                id: 7,
                ville: "Diego-Suarez",
                nom: "Mer d'√âmeraude",
                type: "Plage",
                lat: -12.3333,
                lng: 49.4833,
                prix: "80 000 Ar",
                prixEur: "18 ‚Ç¨",
                prixNum: 80000,
                note: 4.8,
                description: "Un lagon aux couleurs irr√©elles, digne des plus belles cartes postales. L'eau peu profonde et turquoise est id√©ale pour le snorkeling et le kitesurf. Le d√©jeuner se prend souvent sur un √Ælot d√©sert avec au menu : poisson grill√© et riz coco.",
                image: "images/iles/mer-emeraude.jpg",
                acces: "Excursion bateau depuis Ramena (45 min)",
                horaires: "D√©part 8h-9h, retour 16h-17h",
                conseil: "Le vent souffle fort (Varatraza) l'apr√®s-midi, id√©al pour le kite mais prot√©gez-vous du sable.",
                duree: "Journ√©e"
            },
            {
                id: 8,
                ville: "Diego-Suarez",
                nom: "Les Trois Baies",
                type: "Plage",
                lat: -12.25,
                lng: 49.4167,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.6,
                description: "Une succession spectaculaire de baies sauvages : la Baie des Dunes, la Baie des Pigeons et la Baie des Sakalava. C'est un paradis pour les marcheurs et les photographes, offrant des panoramas contrast√©s entre sable blanc, eau turquoise et rochers sombres.",
                image: "images/iles/trois-baies.jpg",
                acces: "Excursion bateau depuis Diego",
                horaires: "Journ√©e compl√®te recommand√©e",
                conseil: "Faites la balade √† pied d'une baie √† l'autre (environ 3h de marche facile) pour profiter pleinement des paysages.",
                duree: "Demi-journ√©e"
            },
            {
                id: 9,
                ville: "Diego-Suarez",
                nom: "Montagne d'Ambre",
                type: "Nature",
                lat: -12.5186,
                lng: 49.1769,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.7,
                description: "Une oasis de fra√Æcheur tropicale qui contraste avec la chaleur de Diego. Cette for√™t pluviale abrite des cascades sacr√©es, des lacs de crat√®re et une biodiversit√© incroyable, dont le plus petit cam√©l√©on du monde, le Brookesia.",
                image: "images/spots/montagne-ambre.jpg",
                acces: "30 km au sud de Diego par RN6, depuis Joffreville",
                horaires: "8h-16h avec guide obligatoire",
                conseil: "Pr√©voyez un v√™tement de pluie et de bonnes chaussures, le climat est humide et plus frais qu'en ville.",
                duree: "4h √† 6h"
            },
            {
                id: 10,
                ville: "Diego-Suarez",
                nom: "Tsingy Rouge",
                type: "Spot Local",
                lat: -12.9165,
                lng: 49.2936,
                prix: "50 000 Ar",
                prixEur: "12 ‚Ç¨",
                prixNum: 50000,
                note: 4.8,
                description: "Une curiosit√© g√©ologique unique, diff√©rente des Tsingy gris. Ici, l'√©rosion a sculpt√© le gr√®s rouge et la lat√©rite pour former des chemin√©es de f√©e aux couleurs flamboyantes. Le contraste avec la v√©g√©tation verte est saisissant.",
                image: "images/spots/tsingy-rouge.jpg",
                acces: "60 km de Diego, route de Joffreville",
                horaires: "Lever/coucher de soleil recommand√©",
                conseil: "La lumi√®re de fin d'apr√®s-midi (Golden Hour) rend le rouge de la roche particuli√®rement intense.",
                duree: "2h"
            },
            {
                id: 11,
                ville: "Diego-Suarez",
                nom: "Windsor Castle",
                type: "Spot Local",
                lat: -12.35,
                lng: 49.3,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.5,
                description: "Un ancien fort militaire perch√© sur un √©norme monolithe rocheux. L'ascension est un peu raide mais la r√©compense est l√† : une vue panoramique √©poustouflante sur le Canal du Mozambique, l'Oc√©an Indien et la baie de Diego.",
                image: "images/spots/windsor-castle.jpg",
                acces: "Accessible depuis Diego, sentier de randonn√©e",
                horaires: "Matin√©e recommand√©e (chaleur)",
                conseil: "Partez tr√®s t√¥t le matin pour √©viter la grosse chaleur pendant la mont√©e des marches.",
                duree: "3h"
            },
            {
                id: 12,
                ville: "Diego-Suarez",
                nom: "Montagne des Fran√ßais",
                type: "Nature",
                lat: -12.3200,
                lng: 49.3400,
                prix: "20 000 Ar",
                prixEur: "5 ‚Ç¨",
                prixNum: 20000,
                note: 4.6,
                description: "Un chemin de croix grimpe le long de cette montagne calcaire recouverte de for√™t s√®che et de baobabs. Au sommet, les ruines d'un fort colonial et une vue imprenable sur toute la baie de Diego vous attendent. C'est aussi un spot d'escalade r√©put√©.",
                image: "images/spots/montagne-francais.jpg",
                acces: "7 km au sud de Diego, accessible en taxi",
                horaires: "6h-18h, guide recommand√©",
                conseil: "L'ascension est expos√©e au soleil, faites-la tr√®s t√¥t le matin ou en fin de journ√©e pour la vue.",
                duree: "3h"
            },
            {
                id: 13,
                ville: "Diego-Suarez",
                nom: "Restaurant Le Melville",
                type: "Restaurant",
                lat: -12.2756,
                lng: 49.2934,
                prix: "35 000 Ar",
                prixEur: "8 ‚Ç¨",
                prixNum: 35000,
                note: 4.7,
                description: "Une adresse historique avec vue sur la baie. Le Melville propose une cuisine g√©n√©reuse centr√©e sur les produits de la mer. Le cadre, un peu hors du temps, rappelle l'√©poque coloniale avec ses boiseries et sa grande terrasse.",
                image: "images/restaurants/le-melville.jpg",
                acces: "Front de mer de Diego, centre-ville",
                horaires: "11h-22h, ferm√© lundi",
                conseil: "Commandez le crabe farci, c'est leur sp√©cialit√© reconnue dans toute la ville.",
                duree: "2h"
            },
            {
                id: 14,
                ville: "Diego-Suarez",
                nom: "Restaurant La Cambusa",
                type: "Restaurant",
                lat: -12.2745,
                lng: 49.2923,
                prix: "40 000 Ar",
                prixEur: "9 ‚Ç¨",
                prixNum: 40000,
                note: 4.8,
                description: "Le repaire des gourmands. Tenu par des Italiens, ce restaurant allie la fra√Æcheur des produits malgaches au savoir-faire italien. Pizzas au feu de bois excellentes et p√¢tes fra√Æches maison, le tout dans une ambiance bistro d√©contract√©e.",
                image: "images/restaurants/la-cambusa.jpg",
                acces: "Centre-ville de Diego, rue Colbert",
                horaires: "12h-14h et 19h-22h",
                conseil: "Leurs carpaccios de poisson (esadon, thon) sont d'une fra√Æcheur absolue, √† tester en entr√©e.",
                duree: "1h30"
            },
            {
                id: 15,
                ville: "Diego-Suarez",
                nom: "Nosy Lonjo (Pain de Sucre)",
                type: "Nature",
                lat: -12.2634,
                lng: 49.3123,
                prix: "40 000 Ar",
                prixEur: "9 ‚Ç¨",
                prixNum: 40000,
                note: 4.6,
                description: "Ce c√¥ne volcanique parfait √©merge de la baie tel un gardien sacr√©. Appel√© 'Pain de Sucre' pour sa forme, il est couvert de v√©g√©tation et abrite des rituels traditionnels. On ne peut g√©n√©ralement pas y d√©barquer, mais en faire le tour en bateau est magique.",
                image: "images/iles/nosy-lonjo.png",
                acces: "Excursion bateau depuis Diego (30 min)",
                horaires: "Matin√©e recommand√©e",
                conseil: "Demandez √† votre piroguier de s'approcher doucement pour voir les oiseaux nichant dans la paroi.",
                duree: "1h"
            },
            {
                id: 16,
                ville: "Diego-Suarez",
                nom: "Grotte des P√™cheurs",
                type: "Spot Local",
                spotLocal: true,
                lat: -12.2389,
                lng: 49.3012,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.8,
                description: "Un lieu fascinant, √† la fois merveille naturelle et temple √† ciel ouvert. Cette grotte s'ouvre sur la mer et sert de lieu de culte aux anc√™tres. L'atmosph√®re y est solennelle et myst√©rieuse, berc√©e par le bruit des vagues.",
                image: "images/spots/grotte-pecheurs.jpg",
                acces: "Plage nord de Ramena √† mar√©e basse uniquement - Demander Paul au march√© aux poissons qui guide gratuitement",
                contactLocal: "Paul, p√™cheur au march√© central de Diego (matin 6h-9h)",
                respect: "Retirer chaussures √† l'entr√©e, ne pas toucher aux offrandes, silence",
                conseil: "V√©rifiez imp√©rativement les horaires de mar√©e, la grotte est inaccessible √† mar√©e haute !",
                duree: "45 min"
            },
            {
                id: 17,
                ville: "Nosy Be",
                nom: "Plage d'Andilana",
                type: "Incontournable",
                lat: -13.2205,
                lng: 48.1824,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.8,
                description: "Sans doute la plage la plus c√©l√®bre de l'√Æle aux Parfums. Andilana offre deux baies aux eaux cristallines, s√©par√©es par une pointe rocheuse. C'est le spot baignade par excellence, avec des eaux calmes et peu profondes, id√©ales pour les familles.",
                image: "images/iles/plage-andilana.jpg",
                acces: "Nord de Nosy Be, 25 km de Hell-Ville",
                horaires: "Accessible 24h/24",
                conseil: "Allez-y en semaine pour √©viter la foule du dimanche, o√π les familles locales viennent pique-niquer.",
                duree: "Demi-journ√©e"
            },
            {
                id: 18,
                ville: "Nosy Be",
                nom: "Nosy Komba",
                type: "Incontournable",
                lat: -13.4619,
                lng: 48.3514,
                prix: "20 000 Ar",
                prixEur: "5 ‚Ç¨",
                prixNum: 20000,
                note: 4.7,
                description: "Surnomm√©e l'√Æle aux l√©muriens, Nosy Komba est une montagne volcanique √©merg√©e de la for√™t. Ici, pas de voitures, tout se fait √† pied. Les l√©muriens Macaco viennent manger dans votre main, et le village d'Ampangorinana est c√©l√®bre pour ses nappes brod√©es.",
                image: "images/iles/nosy-komba.jpg",
                acces: "Bateau depuis Ambatoloaka (25 min)",
                horaires: "Excursion journ√©e ou demi-journ√©e",
                conseil: "Pr√©voyez des bananes (souvent fournies par les guides) pour attirer les l√©muriens sur vos √©paules pour la photo !",
                duree: "3h"
            },
            {
                id: 19,
                ville: "Nosy Be",
                nom: "Parc Marin Nosy Tanikely",
                type: "Nature",
                lat: -13.4833,
                lng: 48.2389,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.9,
                description: "Un v√©ritable aquarium naturel prot√©g√©. Nosy Tanikely est une r√©serve marine o√π il suffit d'un masque et d'un tuba pour nager avec des tortues imbriqu√©es, des m√©rous et des milliers de poissons color√©s √† quelques m√®tres du bord.",
                image: "images/iles/nosy-tanikely.jpg",
                acces: "Excursion bateau, tous clubs de plong√©e",
                horaires: "Sortie journ√©e avec d√©jeuner",
                conseil: "Montez jusqu'au phare au sommet de l'√Æle pour une vue panoramique incroyable sur l'archipel.",
                duree: "Demi-journ√©e"
            },
            {
                id: 20,
                ville: "Nosy Be",
                nom: "Nosy Iranja",
                type: "Incontournable",
                lat: -13.5960,
                lng: 47.8228,
                prix: "150 000 Ar",
                prixEur: "35 ‚Ç¨",
                prixNum: 150000,
                note: 4.9,
                description: "La perle de Madagascar. Deux √Ælots (Nosy Iranja Be et Nosy Iranja Kely) reli√©s par un banc de sable blanc d'un kilom√®tre, submerg√© √† mar√©e haute. L'eau y est d'un bleu turquoise irr√©el. C'est aussi un lieu de ponte important pour les tortues.",
                image: "images/iles/nosy-iranja.jpg",
                acces: "Excursion bateau (1h30), d√©part Hell-Ville",
                horaires: "Journ√©e compl√®te, d√©part 7h",
                conseil: "Attention au soleil ! Le sable blanc r√©fl√©chit √©norm√©ment, cr√®me solaire haute protection obligatoire.",
                duree: "Journ√©e"
            },
            {
                id: 21,
                ville: "Nosy Be",
                nom: "R√©serve Naturelle de Lokobe",
                type: "Nature",
                lat: -13.4147,
                lng: 48.3117,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.6,
                description: "Dernier vestige de la for√™t primaire sambirano qui recouvrait autrefois l'√Æle. Lokobe est un sanctuaire accessible en pirogue traditionnelle. Vous y verrez le l√©murien nocturne (Lepilemur), des boas, des cam√©l√©ons et une flore exub√©rante.",
                image: "images/spots/reserve-lokobe.jpg",
                acces: "Sud-est de l'√Æle, accessible en bateau + randonn√©e",
                horaires: "Excursions guid√©es matin (fra√Æcheur)",
                conseil: "L'arriv√©e en pirogue √† rames est magique, profitez du silence pour observer les martins-p√™cheurs.",
                duree: "Demi-journ√©e"
            },
            {
                id: 22,
                ville: "Nosy Be",
                nom: "Mont Passot",
                type: "Incontournable",
                lat: -13.3214,
                lng: 48.2611,
                prix: "20 000 Ar",
                prixEur: "5 ‚Ç¨",
                prixNum: 20000,
                note: 4.7,
                description: "Le toit de Nosy Be. Ce point culminant offre une vue √† 360 degr√©s sur toute l'√Æle et ses lacs sacr√©s volcaniques. C'est le rendez-vous incontournable pour un coucher de soleil spectaculaire, un cocktail √† la main.",
                image: "images/spots/mont-passot.jpg",
                acces: "Centre de l'√Æle, 15 km de Hell-Ville",
                horaires: "Lever/coucher de soleil recommand√©s",
                conseil: "Arrivez au moins 30 minutes avant le coucher du soleil pour avoir une bonne place sur la terrasse panoramique.",
                duree: "1h30"
            },
            {
                id: 23,
                ville: "Nosy Be",
                nom: "Lemuria Land",
                type: "Culture",
                lat: -13.3556,
                lng: 48.2834,
                prix: "30 000 Ar",
                prixEur: "7 ‚Ç¨",
                prixNum: 30000,
                note: 4.6,
                description: "Une r√©serve zoologique et botanique priv√©e tr√®s bien entretenue. Vous pourrez y voir de pr√®s de nombreuses esp√®ces de l√©muriens, des crocodiles impressionnants et visiter une distillerie d'ylang-ylang traditionnelle toujours en activit√©.",
                image: "images/spots/lemuria-land.jpg",
                acces: "Route Hell-Ville - Andilana, bien indiqu√©",
                horaires: "8h-17h tous les jours",
                conseil: "La visite guid√©e de la distillerie est incluse, ne la manquez pas pour tout savoir sur l'essence de parfum.",
                duree: "2h"
            },
            {
                id: 24,
                ville: "Nosy Be",
                nom: "Plage d'Ambatoloaka",
                type: "Incontournable",
                lat: -13.3639,
                lng: 48.2045,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.2,
                description: "Le quartier g√©n√©ral de la vie nocturne et touristique. C'est ici que tout se passe : d√©parts d'excursions, restaurants les pieds dans le sable, bars anim√©s. L'ambiance y est festive, bruyante et color√©e, m√©langeant touristes et locaux.",
                image: "images/iles/plage-ambatoloaka.jpg",
                acces: "5 km de Hell-Ville, taxi ou location",
                horaires: "24h/24, vie nocturne d√®s 19h",
                conseil: "Parfait pour un ap√©ro au coucher du soleil au 'Badamera', mais pr√©f√©rez Andilana pour le calme absolu.",
                duree: "Soir√©e"
            },
            {
                id: 25,
                ville: "Nosy Be",
                nom: "Nosy Sakatia",
                type: "Nature",
                lat: -13.3108,
                lng: 48.1569,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.7,
                description: "L'√Æle tranquille. Sakatia est authentique, avec ses sentiers de randonn√©e traversant les champs de vanille et d'orchid√©es. La plage aux tortues permet de nager avec d'immenses tortues vertes qui viennent brouter les herbiers √† mar√©e haute.",
                image: "images/iles/nosy-sakatia.jpg",
                acces: "Bateau (20 min) depuis c√¥te ouest Nosy Be",
                horaires: "Excursion journ√©e avec guide local",
                conseil: "Le d√©jeuner chez l'habitant sur la plage est souvent un d√©lice (poisson coco).",
                duree: "Demi-journ√©e"
            },
            {
                id: 26,
                ville: "Nosy Be",
                nom: "Restaurant Cacao Beach",
                type: "Restaurant",
                lat: -13.3178,
                lng: 48.2689,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.8,
                description: "Une institution √† Andilana. Ce restaurant est litt√©ralement sur le sable. On y mange les pieds dans l'eau des fruits de mer d'une fra√Æcheur absolue. L'ambiance est d√©contract√©e, avec des transats pour la sieste apr√®s le repas.",
                image: "images/restaurants/cacao-beach.jpg",
                acces: "Plage d'Andilana, nord de l'√Æle",
                horaires: "10h-22h tous les jours",
                conseil: "R√©servez le buffet de fruits de mer du dimanche midi, c'est gargantuesque et tr√®s couru !",
                duree: "3h (repas + plage)"
            },
            {
                id: 27,
                ville: "Nosy Be",
                nom: "Restaurant L'Heure Bleue",
                type: "Restaurant",
                lat: -13.3645,
                lng: 48.2823,
                prix: "50 000 Ar",
                prixEur: "12 ‚Ç¨",
                prixNum: 50000,
                note: 4.9,
                description: "Le restaurant pour un d√Æner romantique par excellence. Perch√© sur une colline dominant la baie de Madirokely, la vue est imprenable. La cuisine est l'une des meilleures de l'√Æle, m√™lant gastronomie fran√ßaise et produits locaux.",
                image: "images/restaurants/heure-bleue.jpg",
                acces: "Hell-Ville, pr√®s du front de mer",
                horaires: "12h-14h et 19h-22h, ferm√© dimanche",
                conseil: "La terrasse est petite, r√©servez votre table en bordure pour avoir la vue plongeante sur la mer.",
                duree: "2h"
            },
            {
                id: 28,
                ville: "Nosy Be",
                nom: "Plong√©e Nosy Be",
                type: "Culture",
                lat: -13.3634,
                lng: 48.2789,
                prix: "75 000 Ar",
                prixEur: "18 ‚Ç¨",
                prixNum: 75000,
                note: 4.9,
                description: "D√©couvrez les fonds marins exceptionnels de Nosy Be. Ce centre professionnel vous emm√®ne sur les meilleurs spots : tombants, √©paves, et r√©serve de Tanikely. En saison (octobre-novembre), c'est le spot mondial pour nager avec les requins-baleines.",
                image: "images/iles/plongee-nosy-be.webp",
                acces: "Clubs de plong√©e √† Madirokely, Ambatoloaka",
                horaires: "Sorties matin et apr√®s-midi",
                conseil: "Si vous √™tes d√©butant, demandez un bapt√™me √† Tanikely, les conditions sont parfaites (peu profond, clair).",
                duree: "Demi-journ√©e"
            },
            {
                id: 29,
                ville: "Nosy Be",
                nom: "Distillerie Ylang Ylang",
                type: "Culture",
                lat: -13.3508,
                lng: 48.2831,
                prix: "15 000 Ar",
                prixEur: "3.50 ‚Ç¨",
                prixNum: 15000,
                note: 4.5,
                description: "Nosy Be n'est pas l'√Æle aux Parfums pour rien. Visiter une distillerie permet de comprendre le processus ancestral d'extraction de l'essence d'Ylang-Ylang. L'odeur ent√™tante des fleurs jaunes fra√Æchement cueillies est inoubliable.",
                image: "images/spots/ylang-ylang-distillerie.jpg",
                acces: "Plusieurs distilleries sur l'√Æle, guides locaux",
                horaires: "8h-16h, meilleur en matin√©e",
                conseil: "Achetez votre huile essentielle ici, c'est bien moins cher et garanti pur par rapport aux revendeurs de plage.",
                duree: "1h"
            },
            {
                id: 30,
                ville: "Nosy Be",
                nom: "Grotte de la Vierge",
                type: "Spot Local",
                spotLocal: true,
                lat: -13.3456,
                lng: 48.2789,
                prix: "5 000 Ar",
                prixEur: "1 ‚Ç¨",
                prixNum: 5000,
                note: 4.9,
                description: "Un lieu de syncr√©tisme religieux √©tonnant. Cette grotte marine abrite une statue de la Vierge, mais est aussi un lieu de culte pour les esprits locaux. L'acc√®s se fait par la mer, ajoutant au myst√®re. C'est un endroit calme, respect√© et tr√®s photog√©nique.",
                image: "images/spots/grotte-vierge.jpg",
                acces: "En pirogue depuis plage Ambatoloaka - Contacter Marie qui loue sa pirogue et guide (cabane bleue)",
                contactLocal: "Marie, sur la plage d'Ambatoloaka, reconnaissable √† sa cabane bleue",
                respect: "Bougie d'offrande recommand√©e (5000 Ar), silence dans la grotte, respecter les pri√®res en cours",
                conseil: "Parlez √† Marie, la gardienne des lieux, elle conna√Æt toutes les histoires et l√©gendes de la grotte.",
                duree: "1h"
            },
            {
                id: 31,
                ville: "Mahajanga",
                nom: "Cirque Rouge",
                type: "Incontournable",
                lat: -15.6667,
                lng: 46.3167,
                prix: "10 000 Ar",
                prixEur: "2 ‚Ç¨",
                prixNum: 10000,
                note: 4.8,
                description: "Un amphith√©√¢tre naturel sculpt√© par le vent et la pluie. Le Cirque Rouge est c√©l√®bre pour ses chemin√©es de f√©e et ses strates de s√©diments aux 12 nuances de couleurs, du blanc √† l'ocre fonc√©. C'est aussi un site pal√©ontologique important.",
                image: "images/spots/cirque-rouge.jpg",
                acces: "12 km au nord, piste praticable",
                horaires: "T√¥t le matin ou fin d'apr√®s-midi (chaleur)",
                conseil: "Ramassez un petit √©chantillon de sable color√© dans une bouteille (souvenir classique), mais restez raisonnable pour pr√©server le site.",
                duree: "2h"
            },
            {
                id: 32,
                ville: "Mahajanga",
                nom: "Baobabs Sacr√©s de Mahabibo",
                type: "Nature",
                lat: -15.7167,
                lng: 46.3500,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.5,
                description: "Au milieu de la route se dressent majestueusement de gigantesques baobabs. L'un d'eux est particuli√®rement v√©n√©r√© : c'est un arbre sacr√© o√π les habitants viennent d√©poser des offrandes et faire des v≈ìux aux anc√™tres.",
                image: "images/spots/baobabs-sacres.jpg",
                acces: "Route de Katsepy, 15 km",
                horaires: "Lever et coucher de soleil recommand√©s",
                conseil: "Respectez les tissus rouges et les objets (bouteilles, pi√®ces) au pied de l'arbre, ne les touchez surtout pas.",
                duree: "30 min"
            },
            {
                id: 33,
                ville: "Mahajanga",
                nom: "Source Sacr√©e de Marovoay",
                type: "Spot Local",
                spotLocal: true,
                lat: -15.7234,
                lng: 46.3678,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.7,
                description: "Cette source d'eau douce ne tarit jamais et joue un r√¥le centrale dans la vie spirituelle locale. C'est un lieu de rituels Sakalava o√π l'on vient demander b√©n√©diction et gu√©rison. L'atmosph√®re y est paisible et empreinte de respect.",
                image: "images/spots/source-marovoay.jpg",
                acces: "Pr√®s de l'√©cole primaire de Marovoay, chemin de terre √† gauche apr√®s le pont",
                contactLocal: "Demander au directeur de l'√©cole qui indique le chemin",
                respect: "Offrande traditionnelle obligatoire (rhum, miel), ne pas se baigner",
                conseil: "Ne portez pas de rouge (fady/tabou) lors de votre visite √† la source.",
                duree: "45 min"
            },
            {
                id: 34,
                ville: "Mahajanga",
                nom: "Plage de Mahajanga",
                type: "Incontournable",
                lat: -15.7167,
                lng: 46.3167,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.6,
                description: "Le 'Bord' est le c≈ìur battant de Mahajanga. Le soir, tout la ville vient s'y promener pour profiter de la brise marine, manger des brochettes et admirer le cr√©puscule. Le c√©l√®bre Baobab g√©ant, embl√®me de la ville, veille sur les passants.",
                image: "images/iles/plage-mahajanga.jpg",
                acces: "Centre-ville, front de mer (boulevard Poincar√©)",
                horaires: "Accessible 24h/24, meilleur au coucher de soleil",
                conseil: "Go√ªtez absolument aux 'Masikita' (brochettes de z√©bu) vendues par les marchands ambulants le soir.",
                duree: "Soir√©e"
            },
            {
                id: 35,
                ville: "Mahajanga",
                nom: "Parc National d'Ankarafantsika",
                type: "Nature",
                lat: -16.3167,
                lng: 46.8167,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.8,
                description: "Un mix unique de for√™t s√®che, de savane et de zones humides. Le parc est le royaume des oiseaux (le Pygargue de Madagascar y r√®gne) et des l√©muriens (Sifaka Coquereli 'danseurs'). Le lac Ravelobe offre des balades en bateau paisibles.",
                image: "images/spots/ankarafantsika.jpg",
                acces: "115 km sur RN4, accessible en taxi-brousse ou 4x4",
                horaires: "7h-17h avec guide obligatoire",
                conseil: "Faites le circuit du canyon pour voir les formations g√©ologiques 'Lavaka', c'est impressionnant.",
                duree: "Journ√©e"
            },
            {
                id: 36,
                ville: "Mahajanga",
                nom: "Katsepy et le Phare",
                type: "Nature",
                lat: -15.7456,
                lng: 46.2234,
                prix: "15 000 Ar",
                prixEur: "3.50 ‚Ç¨",
                prixNum: 15000,
                note: 4.5,
                description: "Une escapade hors du temps. Apr√®s la travers√©e de l'estuaire en bac, vous arrivez dans un village de brousse paisible. Les l√©muriens √† couronne viennent saluer pr√®s du phare, et l'ambiance est totalement d√©connect√©e de la ville.",
                image: "images/spots/katsepy-phare.jpg",
                acces: "Bac depuis le port de Mahajanga (30 min de travers√©e)",
                horaires: "Bacs : 6h, 8h, 11h, 14h, 16h",
                conseil: "Go√ªtez au crabe √† la noix de coco pr√©par√© par Mme Chabaud, une institution locale √† Katsepy.",
                duree: "Demi-journ√©e"
            },
            {
                id: 37,
                ville: "Mahajanga",
                nom: "Grotte d'Anjohibe",
                type: "Nature",
                lat: -15.5234,
                lng: 46.8567,
                prix: "35 000 Ar",
                prixEur: "8 ‚Ç¨",
                prixNum: 35000,
                note: 4.7,
                description: "Une aventure pour y aller, mais le site est grandiose. Un r√©seau de grottes immenses, des piscines naturelles d'eau douce vert √©meraude et une cascade nich√©e dans la verdure. Les l√©muriens et les perroquets peuplent les arbres alentour.",
                image: "images/spots/grotte-anjohibe.jpg",
                acces: "85 km sur RN4 puis piste. Excursion journ√©e avec guide local",
                horaires: "Excursion d√©part 7h, retour 17h",
                conseil: "La piste est difficile, un vrai 4x4 est indispensable. Partez tr√®s t√¥t le matin.",
                duree: "Journ√©e compl√®te"
            },
            {
                id: 38,
                ville: "Mahajanga",
                nom: "Restaurant Chez Karon",
                type: "Restaurant",
                lat: -15.7178,
                lng: 46.3189,
                prix: "35 000 Ar",
                prixEur: "8 ‚Ç¨",
                prixNum: 35000,
                note: 4.8,
                description: "Une institution culinaire face √† la mer. Chez Karon est c√©l√®bre pour ses fruits de mer ultra-frais et ses plats g√©n√©reux : langoustes grill√©es, crabes farcis, crevettes g√©antes. Le cadre est simple mais l'assiette est royale.",
                image: "images/restaurants/chez-karon.jpg",
                acces: "Boulevard Poincar√©, front de mer",
                horaires: "11h-22h tous les jours",
                conseil: "Leur 'Capitaine √† la plancha' est un d√©lice absolu, demandez la sauce √† l'ail √† part.",
                duree: "2h"
            },
            {
                id: 39,
                ville: "Mahajanga",
                nom: "March√© Couvert de Mahajanga",
                type: "Culture",
                lat: -15.7156,
                lng: 46.3145,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.4,
                description: "Plongez dans l'authenticit√© de Majunga. Ce march√© couvert regorge d'√©pices odorantes, de fruits exotiques color√©s et de poissons s√©ch√©s. C'est aussi le meilleur endroit pour acheter le c√©l√®bre artisanat Sakalava en raphia et en bois.",
                image: "images/villes/marche-couvert-mahajanga.jpg",
                acces: "Centre-ville, rue du Commerce",
                horaires: "5h-18h, meilleur en matin√©e",
                conseil: "Achetez ici votre poivre sauvage de Madagascar et de la vanille, les prix sont bien meilleurs qu'en boutique.",
                duree: "1h"
            },
            {
                id: 40,
                ville: "Mahajanga",
                nom: "Complexe Sportif Ankorondrano",
                type: "Culture",
                lat: -15.7234,
                lng: 46.3212,
                prix: "5 000 Ar",
                prixEur: "1 ‚Ç¨",
                prixNum: 5000,
                note: 4.3,
                description: "Le poumon sportif de la ville. Avec sa piscine olympique (rare dans la r√©gion) et ses terrains de sport, c'est le lieu de rencontre de la jeunesse locale. L'ambiance y est dynamique et conviviale, parfaite pour une pause active.",
                image: "images/villes/complexe-sportif-ankorondrano.jpg",
                acces: "Quartier Ankorondrano, bien indiqu√©",
                horaires: "8h-18h en semaine, 8h-20h weekend",
                conseil: "La piscine est tr√®s fr√©quent√©e le mercredi apr√®s-midi et le week-end, pr√©f√©rez le matin pour nager.",
                duree: "2h"
            },
            {
                id: 41,
                ville: "Andasibe",
                nom: "Parc National Andasibe-Mantadia",
                type: "Nature",
                lat: -18.9333,
                lng: 48.4167,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.8,
                description: "L'un des parcs les plus visit√©s et pour cause : c'est le seul endroit o√π l'on peut entendre le chant puissant de l'Indri, le plus grand l√©murien vivant. La for√™t de brume, les orchid√©es rares et les cam√©l√©ons de Parson g√©ants cr√©ent une ambiance jurassique.",
                image: "images/spots/andasibe-mantadia.jpg",
                acces: "RN2, 140 km d'Antananarivo (3h)",
                horaires: "Circuits 4h √† 6h avec guide obligatoire",
                conseil: "Le matin tr√®s t√¥t (6h-7h) est le meilleur moment pour entendre le chant des Indris.",
                duree: "4h"
            },
            {
                id: 42,
                ville: "Andasibe",
                nom: "R√©serve de Vakona",
                type: "Nature",
                lat: -18.9350,
                lng: 48.4200,
                prix: "35 000 Ar",
                prixEur: "8 ‚Ç¨",
                prixNum: 35000,
                note: 4.7,
                description: "Une exp√©rience inoubliable pour les familles. Sur ¬´ l'√Æle aux l√©muriens ¬ª, les animaux sont en libert√© et n'h√©sitent pas √† sauter sur vos √©paules pour r√©clamer une banane. C'est l'occasion unique de voir de tr√®s pr√®s des esp√®ces difficiles √† observer en for√™t dense.",
                image: "images/spots/reserve-vakona.jpg",
                acces: "√Ä c√¥t√© du parc, bien indiqu√©",
                horaires: "8h-17h tous les jours",
                conseil: "Attention √† vos lunettes de soleil et chapeaux, les l√©muriens sont des petits voleurs espi√®gles !",
                duree: "2h"
            },
            {
                id: 43,
                ville: "Andasibe",
                nom: "Cascade Cach√©e",
                type: "Spot Local",
                spotLocal: true,
                lat: -18.9389,
                lng: 48.4312,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.8,
                description: "Un secret bien gard√© √† l'√©cart des circuits classiques. Cette petite cascade se jette dans un bassin naturel entour√© de foug√®res arborescentes. L'eau y est fra√Æche et revigorante, id√©ale pour se baigner en toute tranquillit√©.",
                image: "images/spots/cascade-cachee.jpg",
                acces: "Sentier derri√®re le Lodge Vakona (non balis√©) - Demander Jean, guide local qui conna√Æt le chemin",
                contactLocal: "Jean, guide √† l'entr√©e de Vakona (gilet orange)",
                respect: "Ne pas laisser de d√©chets, baignade autoris√©e",
                conseil: "Le sentier peut √™tre glissant apr√®s la pluie, pr√©voyez de bonnes chaussures ou des sandales de marche.",
                duree: "1h30"
            },
            {
                id: 44,
                ville: "Isalo",
                nom: "Parc National de l'Isalo",
                type: "Incontournable",
                lat: -22.5833,
                lng: 45.3667,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.9,
                description: "Le Colorado malgache. Un paysage ruiniforme de gr√®s jurassique, entaill√© de canyons profonds. On passe de la savane aride √† des oasis de fra√Æcheur luxuriantes en quelques pas. C'est un parc grandiose, sacr√© pour l'ethnie Bara qui y enterre ses morts.",
                image: "images/spots/parc-isalo.jpg",
                acces: "RN7, entre Tul√©ar et Fianarantsoa",
                horaires: "Circuits √† la journ√©e avec guide obligatoire",
                conseil: "Ne manquez pas le coucher de soleil √† la 'Fen√™tre de l'Isalo', un classique mais toujours spectaculaire.",
                duree: "Journ√©e"
            },
            {
                id: 45,
                ville: "Isalo",
                nom: "Piscine Naturelle",
                type: "Nature",
                lat: -22.5500,
                lng: 45.3833,
                prix: "Inclus parc",
                prixEur: "Inclus",
                prixNum: 0,
                note: 4.8,
                description: "La r√©compense apr√®s la marche. Une vasque d'eau cristalline aliment√©e par une cascade, entour√©e de pandanus et de palmiers, le tout encaiss√© dans la roche. C'est l'image d'√âpinal de l'Isalo, un petit paradis perdu.",
                image: "images/spots/piscine-naturelle.jpg",
                acces: "Circuit de 2-3h dans le parc",
                horaires: "Matin recommand√© (moins de monde)",
                conseil: "L'eau est tr√®s fra√Æche, m√™me en √©t√©, √ßa surprend apr√®s la chaleur du canyon !",
                duree: "1h (pause)"
            },
            {
                id: 46,
                ville: "Isalo",
                nom: "Point de Vue Secret du Canyon",
                type: "Spot Local",
                spotLocal: true,
                lat: -22.5678,
                lng: 45.3945,
                prix: "10 000 Ar",
                prixEur: "2 ‚Ç¨",
                prixNum: 10000,
                note: 4.9,
                description: "Pour ceux qui aiment sortir des sentiers battus. Ce point de vue offre une perspective unique et vertigineuse sur l'immensit√© des canyons de l'Isalo, loin de la foule de la Fen√™tre classique. Le silence y est absolu.",
                image: "images/spots/point-vue-canyon.jpg",
                acces: "Sentier non balis√© √† 500m de la Fen√™tre de l'Isalo - Guide familial obligatoire",
                contactLocal: "Famille Rakoto au village de Ranohira, demander 'Papa Koto'",
                respect: "Coucher de soleil uniquement, ne pas sortir du sentier",
                conseil: "Demandez √† Papa Koto de vous raconter l'histoire des tombeaux que l'on aper√ßoit dans la falaise en face.",
                duree: "1h"
            },
            {
                id: 47,
                ville: "Ifaty",
                nom: "Plage d'Ifaty / Mangily",
                type: "Plage",
                lat: -23.1500,
                lng: 43.6167,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.5,
                description: "Station baln√©aire d√©contract√©e prot√©g√©e par un immense lagon. Ici, on vit au rythme des mar√©es et des p√™cheurs Vezo. La for√™t √©pineuse de l'arri√®re-pays, avec ses baobabs bouteilles, est tout aussi fascinante que le r√©cif corallien.",
                image: "images/iles/plage-ifaty.jpg",
                acces: "27 km au nord de Tul√©ar par piste",
                horaires: "Accessible 24h/24",
                conseil: "Faites une sortie en pirogue Vezo √† balancier t√¥t le matin pour aller voir le r√©cif.",
                duree: "S√©jour"
            },
            {
                id: 48,
                ville: "Ifaty",
                nom: "For√™t de Baobabs de Mangily",
                type: "Nature",
                lat: -23.1667,
                lng: 43.6000,
                prix: "15 000 Ar",
                prixEur: "3.50 ‚Ç¨",
                prixNum: 15000,
                note: 4.6,
                description: "Une for√™t digne d'un conte de f√©es. Ici, les baobabs prennent des formes √©tranges (bouteilles, carottes) pour stocker l'eau. La for√™t abrite aussi des oiseaux end√©miques rares et des plantes succulentes adapt√©es √† la s√©cheresse extr√™me.",
                image: "images/spots/foret-baobabs-mangily.jpg",
                acces: "Village de Mangily, guide local recommand√©",
                horaires: "Matin ou fin d'apr√®s-midi (chaleur)",
                conseil: "Visitez le parc 'Mosa' juste √† c√¥t√© pour voir des l√©muriens et des tortues radiata.",
                duree: "1h30"
            },
            {
                id: 49,
                ville: "Ifaty",
                nom: "Arbre Mill√©naire Sacr√©",
                type: "Spot Local",
                spotLocal: true,
                lat: -23.1723,
                lng: 43.5978,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.9,
                description: "Un g√©ant de la nature. Ce baobab a plus de 1000 ans et une circonf√©rence impressionnante. C'est un arbre sacr√© pour les Vezo, qui le consid√®rent comme la demeure des esprits. On y vient pour des c√©r√©monies et des offrandes.",
                image: "images/spots/arbre-millenaire-sacre.jpg",
                acces: "Int√©rieur des terres √† 2 km d'Ifaty - Pas de panneau, chef du village montre le chemin",
                contactLocal: "Chef du village d'Ifaty (mairie)",
                respect: "Offrande traditionnelle obligatoire (rhum, tabac), ne pas toucher l'arbre",
                conseil: "Soyez tr√®s respectueux et ne touchez l'arbre que si le guide vous y invite explicitement.",
                duree: "45 min"
            },
            {
                id: 50,
                ville: "Ankarana",
                nom: "R√©serve Sp√©ciale de l'Ankarana",
                type: "Incontournable",
                lat: -12.9167,
                lng: 49.0833,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.8,
                description: "Des Tsingy gris ac√©r√©s comme des lames de rasoir, une for√™t s√®che d√©cidue et des grottes immenses abritant des chauves-souris. Ce parc est une aventure g√©ologique. Le 'Pont Suspendu' au-dessus des Tsingy est le spot photo incontournable.",
                image: "images/spots/ankarana.jpg",
                acces: "108 km au sud de Diego-Suarez",
                horaires: "Circuits guid√©s, harnais fourni",
                conseil: "Il fait tr√®s chaud dans les Tsingy (r√©verb√©ration). Partez √† l'aube et prenez beaucoup d'eau.",
                duree: "Journ√©e"
            },
            {
                id: 51,
                ville: "Ankarana",
                nom: "Grottes des Chauves-Souris",
                type: "Nature",
                lat: -12.9234,
                lng: 49.1289,
                prix: "Inclus parc",
                prixEur: "Inclus",
                prixNum: 0,
                note: 4.7,
                description: "Une exploration souterraine fascinante. Ces grottes calcaires sont orn√©es de stalactites et stalagmites g√©antes. Elles abritent d'immenses colonies de chauves-souris frugivores qui s'envolent √† la tomb√©e de la nuit.",
                image: "images/spots/grottes-chauves-souris.jpg",
                acces: "Sentier depuis l'entr√©e du parc",
                horaires: "Lampe frontale obligatoire",
                conseil: "L'odeur de guano peut √™tre forte, un foulard ou un masque peut √™tre utile.",
                duree: "1h"
            },
            {
                id: 52,
                ville: "Ankarana",
                nom: "Grotte Interdite (Anjohibe)",
                type: "Spot Local",
                spotLocal: true,
                lat: -12.9312,
                lng: 49.1345,
                prix: "20 000 Ar",
                prixEur: "5 ‚Ç¨",
                prixNum: 20000,
                note: 4.8,
                description: "Grotte sacr√©e par excellence. Elle abrite les s√©pultures royales de la tribu Antakarana. L'acc√®s est strictement r√©glement√© et soumis √† l'approbation des anc√™tres via les gardiens traditionnels. C'est un lieu charg√©e d'histoire et de myst√®re.",
                image: "images/spots/grotte-interdite-anjohibe.jpg",
                acces: "Autorisation du chef Antakarana obligatoire - Contacter Papa Solo √† Antsiranana qui organise",
                contactLocal: "Papa Solo (guide agr√©√©), bureau pr√®s du march√© central Diego",
                respect: "Interdiction photos, offrande obligatoire, v√™tements couvrants",
                conseil: "Pr√©voyez un budget pour les offrandes rituelles (miel, rhum, z√©bu parfois selon les c√©r√©monies).",
                duree: "Demi-journ√©e"
            },
            {
                id: 53,
                ville: "Mananara",
                nom: "Parc National Mananara-Nord",
                type: "Incontournable",
                lat: -16.1667,
                lng: 49.7667,
                prix: "45 000 Ar",
                prixEur: "10 ‚Ç¨",
                prixNum: 45000,
                note: 4.6,
                description: "L'un des parcs les plus sauvages. Il combine une r√©serve marine et une for√™t humide de basse altitude. C'est le seul endroit o√π l'on peut esp√©rer voir l'Aye-Aye √† l'√©tat sauvage la nuit, ainsi que les baleines √† bosse en saison.",
                image: "images/spots/parc-mananara-nord.jpg",
                acces: "C√¥te est, 250 km de Toamasina (difficile)",
                horaires: "Excursions guid√©es",
                conseil: "L'acc√®s est difficile (piste ou bateau), c'est une exp√©dition pour les aventuriers, pas pour le tourisme de masse.",
                duree: "2 jours"
            },
            {
                id: 54,
                ville: "Mananara",
                nom: "Parc National Nosy Atafana",
                type: "Nature",
                lat: -16.1833,
                lng: 49.8000,
                prix: "20 000 Ar",
                prixEur: "5 ‚Ç¨",
                prixNum: 20000,
                note: 4.7,
                description: "Un parc marin exceptionnel situ√© au large de la c√¥te Est. Il prot√®ge des √©cosyst√®mes coralliens pr√©serv√©s. C'est l'un des rares endroits o√π la for√™t humide dense rejoint presque la mer, cr√©ant des paysages uniques de jungle et de plage.",
                image: "images/spots/parc-mananara-nord.jpg",
                acces: "Pirogue depuis Mananara (15 min)",
                horaires: "D√©parts matin et apr√®s-midi",
                conseil: "C'est un spot de r√©serve de Biosph√®re, respectez scrupuleusement les consignes (pas de coquillages, pas de touche au corail).",
                duree: "Demi-journ√©e"
            },
            {
                id: 55,
                ville: "Mananara",
                nom: "Lac aux Crocodiles Sacr√©s",
                type: "Spot Local",
                spotLocal: true,
                lat: -16.1734,
                lng: 49.7612,
                prix: "Gratuit",
                prixEur: "Gratuit",
                prixNum: 0,
                note: 4.8,
                description: "Lac habit√© par crocodiles v√©n√©r√©s comme anc√™tres. Site sacr√© Betsimisaraka.",
                image: "images/spots/lac-crocodiles-sacres.jpg",
                acces: "For√™t √† 5 km de Mananara, sentier depuis le village - Parler au gardien du lac",
                contactLocal: "Gardien au village (maison toit rouge)",
                respect: "Interdiction formelle de photographier, ne pas montrer du doigt, offrande requise"
            }
        ];

        const PHRASES_DATA = {
            "Salutations & Politesse": [
                { fr: "Bonjour", mg: "Manao ahoana", phonetic: "man-ao a-ho-ana" },
                { fr: "Merci", mg: "Misaotra", phonetic: "mi-sao-tra" },
                { fr: "S'il vous pla√Æt", mg: "Azafady", phonetic: "a-za-fa-dy" },
                { fr: "Excusez-moi", mg: "Miala tsiny", phonetic: "mi-a-la tsi-ny" },
                { fr: "Au revoir", mg: "Veloma", phonetic: "ve-lo-ma" },
                { fr: "Oui", mg: "Eny", phonetic: "e-ny" },
                { fr: "Non", mg: "Tsia", phonetic: "tsi-a" }
            ],
            "Se pr√©senter": [
                { fr: "Je m'appelle...", mg: "[Nom] no anarako", phonetic: "[nom] no a-na-ra-ko" },
                { fr: "Je suis fran√ßais(e)", mg: "Frantsay aho", phonetic: "fran-tsa√Ø a-ho" },
                { fr: "Je ne parle pas malgache", mg: "Tsy mahay miteny malagasy aho", phonetic: "tsi ma-ha√Ø mi-te-ny ma-la-ga-sy a-ho" },
                { fr: "Je suis en vacances", mg: "Miala sasatra aho", phonetic: "mi-a-la sa-sa-tra a-ho" },
                { fr: "Enchant√©(e)", mg: "Faly mahafantatra anao", phonetic: "fa-ly ma-ha-fan-ta-tra a-nao" }
            ],
            "Se d√©placer": [
                { fr: "O√π est la plage ?", mg: "Aiza ny moron-dranomasina ?", phonetic: "a√Ø-za ni mo-ron-dra-no-ma-si-na" },
                { fr: "Combien pour Diego ?", mg: "Hoatrinona ny ho any Antsiranana ?", phonetic: "ho-a-tri-no-na ni ho a-ny an-tsi-ra-na-na" },
                { fr: "Je suis perdu(e)", mg: "Very l√†lana aho", phonetic: "ve-ry la-la-na a-ho" },
                { fr: "C'est loin ?", mg: "Lavitra ve ?", phonetic: "la-vi-tra ve" },
                { fr: "√Ä droite", mg: "Havanana", phonetic: "ha-va-na-na" },
                { fr: "√Ä gauche", mg: "Havia", phonetic: "hi-vi-a" },
                { fr: "Tout droit", mg: "Mahitsy", phonetic: "ma-hit-sy" },
                { fr: "Arr√™tez ici", mg: "Mijanona eto", phonetic: "mi-ja-no-na e-to" }
            ],
            "N√©gocier & Acheter": [
                { fr: "Combien √ßa co√ªte ?", mg: "Ohatrinona ny vidiny ?", phonetic: "o-ha-tri-no-na ni vi-di-ny" },
                { fr: "C'est trop cher", mg: "Lafo be loatra izany", phonetic: "la-fo be lo-a-tra i-za-ny" },
                { fr: "Moins cher possible ?", mg: "Mora kokoa ve ?", phonetic: "mo-ra ko-ko-a ve" },
                { fr: "Je prends √ßa", mg: "Alako io", phonetic: "a-la-ko i-o" },
                { fr: "Vous acceptez les euros ?", mg: "Mandray euros ve ianao ?", phonetic: "man-dra√Ø e-u-ros ve i-a-nao" },
                { fr: "Pas de monnaie", mg: "Tsy misy vola madinika", phonetic: "tsi mi-sy vo-la ma-di-ni-ka" }
            ],
            "Restaurant": [
                { fr: "Une table pour deux", mg: "Latabatra roa azafady", phonetic: "la-ta-ba-tra ro-a a-za-fa-dy" },
                { fr: "Le menu s'il vous pla√Æt", mg: "Ny menu azafady", phonetic: "ni me-nu a-za-fa-dy" },
                { fr: "L'addition", mg: "Ny faktiora", phonetic: "ni fak-ti-o-ra" },
                { fr: "C'√©tait d√©licieux", mg: "Matsiro be", phonetic: "ma-tsi-ro be" },
                { fr: "Eau min√©rale", mg: "Rano mineraly", phonetic: "ra-no mi-ne-ra-ly" },
                { fr: "Sans piment", mg: "Tsy misy sakay", phonetic: "tsi mi-sy sa-ka√Ø" },
                { fr: "Je suis v√©g√©tarien(ne)", mg: "Tsy mihinana hena aho", phonetic: "tsi mi-hi-na-na he-na a-ho" }
            ],
            "Nombres": [
                { fr: "1", mg: "Iray", phonetic: "i-ra√Ø" },
                { fr: "2", mg: "Roa", phonetic: "ro-a" },
                { fr: "3", mg: "Telo", phonetic: "te-lo" },
                { fr: "4", mg: "Efatra", phonetic: "e-fa-tra" },
                { fr: "5", mg: "Dimy", phonetic: "di-my" },
                { fr: "10", mg: "Folo", phonetic: "fo-lo" },
                { fr: "100", mg: "Zato", phonetic: "za-to" },
                { fr: "1 000", mg: "Arivo", phonetic: "a-ri-vo" }
            ],
            "Urgence & Sant√©": [
                { fr: "Aidez-moi !", mg: "Vonjeo aho !", phonetic: "von-je-o a-ho" },
                { fr: "Mal √† la t√™te", mg: "Marary ny lohako", phonetic: "ma-ra-ry ni lo-ha-ko" },
                { fr: "O√π est la pharmacie ?", mg: "Aiza ny fivarotam-panafody ?", phonetic: "a√Ø-za ni fi-va-ro-tam-fa-na-fo-dy" },
                { fr: "H√¥pital", mg: "Hopitaly", phonetic: "ho-pi-ta-ly" },
                { fr: "J'ai besoin d'un docteur", mg: "Mila dokotera aho", phonetic: "mi-la do-ko-te-ra a-ho" },
                { fr: "Allergie", mg: "Alerizy", phonetic: "a-le-ri-zy" }
            ],
            "H√©bergement & M√©t√©o": [
                { fr: "H√¥tel", mg: "Hotely", phonetic: "ho-te-ly" },
                { fr: "Chambre", mg: "Efitrano", phonetic: "e-fi-tra-no" },
                { fr: "Il fait chaud", mg: "Mafana", phonetic: "ma-fa-na" },
                { fr: "Il pleut", mg: "Avy ny orana", phonetic: "a-vy ni o-ra-na" }
            ]
        };

        const CHECKLIST_ITEMS = [
            "SIM locale Telma",
            "Argent liquide (CB rare)",
            "Adaptateur prise C/E",
            "Cr√®me solaire SPF50+",
            "Lampe frontale",
            "Carnet + stylo",
            "Powerbank 20 000 mAh",
            "Sac √©tanche",
            "R√©pulsif anti-moustiques",
            "Trousse premiers secours"
        ];

        // ============================================
        // VARIABLES GLOBALES
        // ============================================

        let map;
        let markersLayer;
        let currentTheme = localStorage.getItem('theme') || 'light';
        let exchangeRate = parseFloat(localStorage.getItem('exchangeRate')) || 4250;
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let checklist = JSON.parse(localStorage.getItem('checklist')) || [];
        let deferredPrompt;

        // ============================================
        // INITIALISATION
        // ============================================

        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            initNavigation();
            initMap();
            initLanguePage();
            initOutilsPage();
            initCityPages();
            initSpotsPage();
            initModal();
            initInstallPrompt();
            registerServiceWorker();
        });

        // ============================================
        // TH√àME
        // ============================================

        function initTheme() {
            document.documentElement.setAttribute('data-theme', currentTheme);
            updateThemeToggle();

            document.getElementById('themeToggle').addEventListener('click', () => {
                currentTheme = currentTheme === 'light' ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', currentTheme);
                localStorage.setItem('theme', currentTheme);
                updateThemeToggle();
            });
        }

        function updateThemeToggle() {
            const toggle = document.getElementById('themeToggle');
            toggle.textContent = currentTheme === 'light' ? '‚òÄÔ∏è' : 'üåô';
        }

        // ============================================
        // NAVIGATION
        // ============================================

        function initNavigation() {
            const navBtns = document.querySelectorAll('.nav-btn');
            const shortcuts = document.querySelectorAll('.shortcut-card');

            navBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const page = btn.dataset.page;
                    navigateToPage(page);
                });
            });

            shortcuts.forEach(card => {
                card.addEventListener('click', () => {
                    const page = card.dataset.goto;
                    navigateToPage(page);
                });
            });
        }

        function navigateToPage(pageName) {
            // Cacher toutes les sections
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });

            // Retirer active de tous les boutons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Afficher la section demand√©e
            const pageSection = document.getElementById(`page-${pageName}`);
            if (pageSection) {
                pageSection.classList.add('active');
            }

            // Activer le bouton correspondant
            const activeBtn = document.querySelector(`[data-page="${pageName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
                activeBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }

            // Scroll en haut
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ============================================
        // CARTE
        // ============================================

        function initMap() {
            map = L.map('map').setView([-18.8792, 47.5079], 6);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors',
                maxZoom: 18
            }).addTo(map);

            markersLayer = L.markerClusterGroup({
                chunkedLoading: true,
                spiderfyOnMaxZoom: true,
                showCoverageOnHover: false,
                zoomToBoundsOnClick: true
            });

            updateMapMarkers();
            map.addLayer(markersLayer);

            // Filtres
            document.querySelectorAll('.filter-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', updateMapMarkers);
            });
        }

        function updateMapMarkers() {
            markersLayer.clearLayers();

            const filters = getActiveFilters();
            const filteredLieux = LIEUX_DATA.filter(lieu => lieu.nom && matchesFilters(lieu, filters));

            filteredLieux.forEach(lieu => {
                const icon = L.divIcon({
                    className: 'custom-marker',
                    html: lieu.spotLocal ? 'üìç' : 'üìå',
                    iconSize: [32, 32]
                });

                const marker = L.marker([lieu.lat, lieu.lng], { icon });

                const popupContent = `
                    <div class="popup-content">
                        <div class="popup-title">${lieu.nom}</div>
                        <div class="popup-price">${lieu.prix} (${lieu.prixEur})</div>
                        <div class="popup-rating">‚≠ê ${lieu.note}</div>
                        ${lieu.spotLocal ? '<div class="badge-spot">üìç Spot Local</div>' : ''}
                    </div>
                `;

                marker.bindPopup(popupContent);
                marker.on('click', () => showLieuDetails(lieu));

                markersLayer.addLayer(marker);
            });
        }

        function getActiveFilters() {
            const filters = {
                villes: [],
                types: [],
                prix: []
            };

            // Villes
            document.querySelectorAll('[id^="filter-"][id$="antananarivo"], [id$="diego"], [id$="nosybe"], [id$="mahajanga"], [id$="andasibe"], [id$="isalo"], [id$="ifaty"], [id$="ankarana"], [id$="mananara"]').forEach(cb => {
                if (cb.checked) {
                    const ville = cb.id.replace('filter-', '');
                    const villeMap = {
                        'antananarivo': 'Antananarivo',
                        'diego': 'Diego-Suarez',
                        'nosybe': 'Nosy Be',
                        'mahajanga': 'Mahajanga',
                        'andasibe': 'Andasibe',
                        'isalo': 'Isalo',
                        'ifaty': 'Ifaty',
                        'ankarana': 'Ankarana',
                        'mananara': 'Mananara'
                    };
                    filters.villes.push(villeMap[ville]);
                }
            });

            // Types
            if (document.getElementById('filter-incontournable').checked) filters.types.push('Incontournable');
            if (document.getElementById('filter-spotlocal').checked) filters.types.push('Spot Local');
            if (document.getElementById('filter-nature').checked) filters.types.push('Nature');
            if (document.getElementById('filter-restaurant').checked) filters.types.push('Restaurant');
            if (document.getElementById('filter-culture').checked) filters.types.push('Culture');

            // Prix
            if (document.getElementById('filter-gratuit').checked) filters.prix.push('gratuit');
            if (document.getElementById('filter-economique').checked) filters.prix.push('economique');
            if (document.getElementById('filter-moyen').checked) filters.prix.push('moyen');

            return filters;
        }

        function matchesFilters(lieu, filters) {
            // Ville
            if (filters.villes.length > 0 && !filters.villes.includes(lieu.ville)) {
                return false;
            }

            // Type
            if (filters.types.length > 0) {
                const lieuTypes = [lieu.type];
                if (lieu.spotLocal) lieuTypes.push('Spot Local');
                if (!lieuTypes.some(t => filters.types.includes(t))) {
                    return false;
                }
            }

            // Prix
            if (filters.prix.length > 0) {
                let prixCategory;
                if (lieu.prixNum === 0) prixCategory = 'gratuit';
                else if (lieu.prixNum < 10000) prixCategory = 'economique';
                else prixCategory = 'moyen';

                if (!filters.prix.includes(prixCategory)) {
                    return false;
                }
            }

            return true;
        }

        // ============================================
        // PAGES VILLES
        // ============================================

        function initCityPages() {
            // Mapping explicite ville ‚Üí ID de page HTML
            const villeToPageId = {
                'Antananarivo': 'page-antananarivo',
                'Diego-Suarez': 'page-diego',
                'Nosy Be': 'page-nosybe',
                'Mahajanga': 'page-mahajanga',
                'Andasibe': 'page-andasibe',
                'Isalo': 'page-isalo',
                'Ifaty': 'page-ifaty',
                'Ankarana': 'page-ankarana',
                'Mananara': 'page-mananara'
            };

            Object.keys(villeToPageId).forEach(ville => {
                const pageId = villeToPageId[ville];
                const pageElement = document.getElementById(pageId);
                if (!pageElement) {
                    console.warn(`Page non trouv√©e pour ${ville} (ID: ${pageId})`);
                    return;
                }

                const lieuxVille = LIEUX_DATA.filter(l => l.ville === ville && l.nom);

                const html = `
                    <h2 style="font-family: var(--font-display); font-size: 2rem; margin-bottom: 30px; color: var(--text-primary);">
                        ${getVilleEmoji(ville)} ${ville}
                    </h2>
                    <div class="lieux-grid">
                        ${lieuxVille.map(lieu => createLieuCard(lieu)).join('')}
                    </div>
                `;

                pageElement.innerHTML = html;

                // Event listeners
                pageElement.querySelectorAll('.btn-details').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const lieuId = parseInt(e.target.dataset.lieuId);
                        const lieu = LIEUX_DATA.find(l => l.id === lieuId);
                        if (lieu) showLieuDetails(lieu);
                    });
                });
            });
        }

        function getVilleEmoji(ville) {
            const emojis = {
                'Antananarivo': 'üèõÔ∏è',
                'Diego-Suarez': 'üèùÔ∏è',
                'Nosy Be': 'üå¥',
                'Mahajanga': 'üåä',
                'Andasibe': 'üåø',
                'Isalo': 'üèúÔ∏è',
                'Ifaty': 'üèñÔ∏è',
                'Ankarana': 'üï≥Ô∏è',
                'Mananara': 'üêä'
            };
            return emojis[ville] || 'üìç';
        }

        function createLieuCard(lieu) {
            const prixClass = lieu.prixNum === 0 ? 'gratuit' : lieu.prixNum < 10000 ? 'abordable' : 'premium';

            return `
                <article class="lieu-card">
                    <img src="${lieu.image}" alt="${lieu.nom}" class="lieu-image" loading="lazy">
                    <div class="lieu-content">
                        <div class="lieu-header">
                            <h3 class="lieu-title">${lieu.nom}</h3>
                            ${lieu.spotLocal ? '<span class="badge-spot">üìç Spot Local</span>' : `<span class="badge-type">${lieu.type}</span>`}
                        </div>
                        <div class="lieu-meta">
                            <span class="lieu-prix ${prixClass}">${lieu.prix}</span>
                            <span class="lieu-note">‚≠ê ${lieu.note}</span>
                        </div>
                        <p class="lieu-desc">${lieu.description}</p>
                        <button class="btn-details" data-lieu-id="${lieu.id}">Voir d√©tails</button>
                    </div>
                </article>
            `;
        }

        // ============================================
        // PAGE SPOTS LOCAUX
        // ============================================

        function initSpotsPage() {
            const spotsContainer = document.getElementById('spotsContainer');
            const spots = LIEUX_DATA.filter(l => l.spotLocal && l.nom);

            spotsContainer.innerHTML = spots.map(lieu => createLieuCard(lieu)).join('');

            spotsContainer.querySelectorAll('.btn-details').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const lieuId = parseInt(e.target.dataset.lieuId);
                    const lieu = LIEUX_DATA.find(l => l.id === lieuId);
                    if (lieu) showLieuDetails(lieu);
                });
            });
        }

        // ============================================
        // MODAL
        // ============================================

        function initModal() {
            const modal = document.getElementById('modal');
            const closeBtn = document.getElementById('modalClose');

            closeBtn.addEventListener('click', () => {
                modal.classList.remove('active');
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        }

        function showLieuDetails(lieu) {
            const modal = document.getElementById('modal');
            const modalImage = document.getElementById('modalImage');
            const modalTitle = document.getElementById('modalTitle');
            const modalBadges = document.getElementById('modalBadges');
            const modalInfoGrid = document.getElementById('modalInfoGrid');
            const modalSections = document.getElementById('modalSections');

            modalImage.src = lieu.image;
            modalImage.alt = lieu.nom;
            modalTitle.textContent = lieu.nom;

            // Badges
            let badgesHTML = '';
            if (lieu.spotLocal) {
                badgesHTML += '<span class="badge-spot">üìç Spot Local</span> ';
            }
            badgesHTML += `<span class="badge-type">${lieu.type}</span>`;
            modalBadges.innerHTML = badgesHTML;

            // Infos grille
            modalInfoGrid.innerHTML = `
                <div class="modal-info-item">
                    <div class="modal-info-label">Ville</div>
                    <div class="modal-info-value">${lieu.ville}</div>
                </div>
                <div class="modal-info-item">
                    <div class="modal-info-label">Prix</div>
                    <div class="modal-info-value">${lieu.prix} (${lieu.prixEur})</div>
                </div>
                <div class="modal-info-item">
                    <div class="modal-info-label">Note</div>
                    <div class="modal-info-value">‚≠ê ${lieu.note}</div>
                </div>
                ${lieu.duree ? `
                <div class="modal-info-item">
                    <div class="modal-info-label">Dur√©e</div>
                    <div class="modal-info-value">‚è±Ô∏è ${lieu.duree}</div>
                </div>` : ''}
            `;

            // Sections
            let sectionsHTML = `
                <div class="modal-section">
                    <div class="modal-section-title">Description</div>
                    <div class="modal-section-content" style="line-height: 1.6;">${lieu.description}</div>
                </div>
                ${lieu.conseil ? `
                <div class="modal-section" style="background: rgba(255, 215, 0, 0.1); border-left: 3px solid #FFD700; padding: 10px;">
                    <div class="modal-section-title" style="color: #FFD700;">üí° Conseil du Local</div>
                    <div class="modal-section-content">${lieu.conseil}</div>
                </div>` : ''}
                <div class="modal-section">
                    <div class="modal-section-title">Acc√®s</div>
                    <div class="modal-section-content">${lieu.acces}</div>
                </div>
            `;

            if (lieu.horaires) {
                sectionsHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">Horaires</div>
                        <div class="modal-section-content">${lieu.horaires}</div>
                    </div>
                `;
            }

            if (lieu.contactLocal) {
                sectionsHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">Contact Local</div>
                        <div class="modal-section-content">${lieu.contactLocal}</div>
                    </div>
                `;
            }

            if (lieu.respect) {
                sectionsHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">‚ö†Ô∏è Respect Requis</div>
                        <div class="modal-section-content">${lieu.respect}</div>
                    </div>
                `;
            }

            modalSections.innerHTML = sectionsHTML;

            modal.classList.add('active');
        }

        // ============================================
        // PAGE LANGUE
        // ============================================

        function initLanguePage() {
            const container = document.getElementById('accordionContainer');
            const searchInput = document.getElementById('langueSearch');

            Object.keys(PHRASES_DATA).forEach((category, index) => {
                const accordionHTML = createAccordion(category, PHRASES_DATA[category], index);
                container.insertAdjacentHTML('beforeend', accordionHTML);
            });

            // Event listeners accord√©ons
            document.querySelectorAll('.accordion-header').forEach(header => {
                header.addEventListener('click', () => {
                    const item = header.parentElement;
                    const wasOpen = item.classList.contains('open');

                    // Fermer tous
                    document.querySelectorAll('.accordion-item').forEach(i => i.classList.remove('open'));

                    // Ouvrir celui-ci si ferm√©
                    if (!wasOpen) {
                        item.classList.add('open');
                    }
                });
            });

            // Recherche
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                document.querySelectorAll('.phrase-item').forEach(item => {
                    const fr = item.querySelector('.phrase-fr').textContent.toLowerCase();
                    const mg = item.querySelector('.phrase-mg').textContent.toLowerCase();
                    if (fr.includes(query) || mg.includes(query)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });

            // Boutons actions phrases
            container.addEventListener('click', (e) => {
                if (e.target.classList.contains('btn-audio')) {
                    playAudio(e.target.dataset.text);
                } else if (e.target.classList.contains('btn-copy')) {
                    copyToClipboard(e.target.dataset.text);
                } else if (e.target.classList.contains('btn-favorite')) {
                    toggleFavorite(e.target);
                }
            });
        }

        function createAccordion(category, phrases, index) {
            const phrasesHTML = phrases.map((phrase, i) => `
                <div class="phrase-item">
                    <div class="phrase-content">
                        <div class="phrase-fr">${phrase.fr}</div>
                        <div class="phrase-mg">${phrase.mg}</div>
                        <div class="phrase-phonetic">(${phrase.phonetic})</div>
                    </div>
                    <div class="phrase-actions">
                        <button class="btn-icon btn-audio" data-text="${phrase.mg}" title="√âcouter">üîä</button>
                        <button class="btn-icon btn-copy" data-text="${phrase.mg}" title="Copier">üìã</button>
                        <button class="btn-icon btn-favorite ${favorites.includes(`${category}-${i}`) ? 'active' : ''}" data-category="${category}" data-index="${i}" title="Favori">‚≠ê</button>
                    </div>
                </div>
            `).join('');

            return `
                <div class="accordion-item ${index === 0 ? 'open' : ''}">
                    <div class="accordion-header">
                        <h3 class="accordion-title">
                            ${getCategoryEmoji(category)} ${category}
                        </h3>
                        <span class="accordion-icon">‚ñº</span>
                    </div>
                    <div class="accordion-body">
                        <div class="accordion-content">
                            ${phrasesHTML}
                        </div>
                    </div>
                </div>
            `;
        }

        function getCategoryEmoji(category) {
            const emojis = {
                "Salutations & Politesse": "üëã",
                "Se pr√©senter": "üôã",
                "Se d√©placer": "üö∂",
                "N√©gocier & Acheter": "üí∞",
                "Restaurant": "üçΩÔ∏è",
                "Nombres": "üî¢",
                "Urgence & Sant√©": "üö®"
            };
            return emojis[category] || "üí¨";
        }

        function playAudio(text) {
            // Simulation audio (Speech Synthesis API)
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'mg-MG';
            utterance.rate = 0.8;
            window.speechSynthesis.speak(utterance);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Feedback visuel
                alert('Copi√© dans le presse-papiers !');
            });
        }

        function toggleFavorite(btn) {
            const key = `${btn.dataset.category}-${btn.dataset.index}`;
            const index = favorites.indexOf(key);

            if (index > -1) {
                favorites.splice(index, 1);
                btn.classList.remove('active');
            } else {
                favorites.push(key);
                btn.classList.add('active');
            }

            localStorage.setItem('favorites', JSON.stringify(favorites));
        }

        // ============================================
        // PAGE OUTILS
        // ============================================

        function initOutilsPage() {
            // Convertisseur
            const inputAr = document.getElementById('inputAr');
            const inputEuro = document.getElementById('inputEuro');
            const rateDisplay = document.getElementById('rateDisplay');
            const btnModifyRate = document.getElementById('btnModifyRate');

            rateDisplay.textContent = exchangeRate;

            inputAr.addEventListener('input', () => {
                const ar = parseFloat(inputAr.value) || 0;
                inputEuro.value = (ar / exchangeRate).toFixed(2);
            });

            inputEuro.addEventListener('input', () => {
                const euro = parseFloat(inputEuro.value) || 0;
                inputAr.value = Math.round(euro * exchangeRate);
            });

            btnModifyRate.addEventListener('click', () => {
                const newRate = prompt('Entrez le nouveau taux (1 ‚Ç¨ = X Ar)', exchangeRate);
                if (newRate && !isNaN(newRate)) {
                    exchangeRate = parseFloat(newRate);
                    localStorage.setItem('exchangeRate', exchangeRate);
                    rateDisplay.textContent = exchangeRate;
                    // Recalculer
                    inputAr.dispatchEvent(new Event('input'));
                }
            });

            // Checklist
            const checklistContainer = document.getElementById('checklistContainer');

            CHECKLIST_ITEMS.forEach((item, index) => {
                const checked = checklist.includes(index);
                const html = `
                    <div class="checklist-item ${checked ? 'checked' : ''}" data-index="${index}">
                        <div class="checklist-checkbox"></div>
                        <span class="checklist-label">${item}</span>
                    </div>
                `;
                checklistContainer.insertAdjacentHTML('beforeend', html);
            });

            checklistContainer.addEventListener('click', (e) => {
                const item = e.target.closest('.checklist-item');
                if (!item) return;

                const index = parseInt(item.dataset.index);
                const checklistIndex = checklist.indexOf(index);

                if (checklistIndex > -1) {
                    checklist.splice(checklistIndex, 1);
                    item.classList.remove('checked');
                } else {
                    checklist.push(index);
                    item.classList.add('checked');
                }

                localStorage.setItem('checklist', JSON.stringify(checklist));
            });
        }

        // ============================================
        // PWA
        // ============================================

        function initInstallPrompt() {
            const installPrompt = document.getElementById('installPrompt');
            const installBtn = document.getElementById('installBtn');
            const installClose = document.getElementById('installClose');

            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                installPrompt.classList.add('active');
            });

            installBtn.addEventListener('click', async () => {
                if (!deferredPrompt) return;

                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;

                if (outcome === 'accepted') {
                    installPrompt.classList.remove('active');
                }

                deferredPrompt = null;
            });

            installClose.addEventListener('click', () => {
                installPrompt.classList.remove('active');
            });
        }

        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.error('Service Worker error:', err));
            }
        }
    </script>
</body>

</html>